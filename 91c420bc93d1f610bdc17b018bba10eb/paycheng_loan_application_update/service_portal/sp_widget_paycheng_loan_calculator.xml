<?xml version="1.0" encoding="UTF-8"?>
<sp_widget action="INSERT_OR_UPDATE" category="custom" css="" data_table="" description="Loan Payment Calculator" id="paycheng_loan_calculator" name="Loan Calculator" public="true" sys_class_name="sp_widget" sys_id="widget_loan_calculator" sys_package="x_1603889_paycheng" sys_scope="x_1603889_paycheng" sys_update_name="sp_widget_paycheng_loan_calculator">
    <category>custom</category>
    <client_script><![CDATA[function() {
  var c = this;
  
  c.loanAmount = 100000;
  c.term = 12;
  c.interestRate = 12;
  c.result = {};
  
  c.calculate = function() {
    var principal = parseFloat(c.loanAmount) || 0;
    var months = parseInt(c.term) || 12;
    var annualRate = parseFloat(c.interestRate) / 100 || 0.12;
    var monthlyRate = annualRate / 12;
    
    if (principal > 0 && months > 0) {
      // Amortization formula: M = P * [r(1+r)^n] / [(1+r)^n - 1]
      var monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / 
                          (Math.pow(1 + monthlyRate, months) - 1);
      
      var totalPayment = monthlyPayment * months;
      var totalInterest = totalPayment - principal;
      
      c.result = {
        monthlyPayment: monthlyPayment,
        totalPayment: totalPayment,
        totalInterest: totalInterest
      };
    }
  };
  
  // Initial calculation
  c.calculate();
}]]></client_script>
    <controller_as>c</controller_as>
    <css/>
    <data_table/>
    <demo_data/>
    <description>Loan Payment Calculator</description>
    <docs/>
    <field_list/>
    <has_instance>true</has_instance>
    <id>paycheng_loan_calculator</id>
    <internal>false</internal>
    <link/>
    <name>Loan Calculator</name>
    <option_schema/>
    <public>true</public>
    <roles/>
    <script/>
    <servicenow>false</servicenow>
    <sys_class_name>sp_widget</sys_class_name>
    <sys_created_by>admin</sys_created_by>
    <sys_created_on>2025-11-16 15:00:00</sys_created_on>
    <sys_id>widget_loan_calculator</sys_id>
    <sys_mod_count>0</sys_mod_count>
    <sys_name>Loan Calculator</sys_name>
    <sys_package display_value="Paycheng" source="x_1603889_paycheng">x_1603889_paycheng</sys_package>
    <sys_policy/>
    <sys_scope display_value="Paycheng" source="x_1603889_paycheng">x_1603889_paycheng</sys_scope>
    <sys_update_name>sp_widget_paycheng_loan_calculator</sys_update_name>
    <sys_updated_by>admin</sys_updated_by>
    <sys_updated_on>2025-11-16 15:00:00</sys_updated_on>
    <template><![CDATA[<div class="loan-card">
  <h2 class="text-center mb-4">Loan Payment Calculator</h2>
  
  <div class="row">
    <div class="col-md-6">
      <div class="form-group">
        <label>Loan Amount (₱)</label>
        <input type="number" class="form-control" ng-model="c.loanAmount" 
               min="10000" max="5000000" step="1000" ng-change="c.calculate()">
        <input type="range" class="form-control-range" ng-model="c.loanAmount" 
               min="10000" max="5000000" step="1000" ng-change="c.calculate()">
        <small class="form-text text-muted">₱10,000 - ₱5,000,000</small>
      </div>
      
      <div class="form-group">
        <label>Loan Term</label>
        <select class="form-control" ng-model="c.term" ng-change="c.calculate()">
          <option value="12">12 months (1 year)</option>
          <option value="24">24 months (2 years)</option>
          <option value="36">36 months (3 years)</option>
          <option value="48">48 months (4 years)</option>
          <option value="60">60 months (5 years)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Interest Rate (% per year)</label>
        <input type="number" class="form-control" ng-model="c.interestRate" 
               min="5" max="25" step="0.5" ng-change="c.calculate()">
        <small class="form-text text-muted">Current rate: 12% per annum</small>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="calculator-result" ng-if="c.result.monthlyPayment">
        <h4 class="text-center mb-4">Estimated Payment</h4>
        
        <div class="result-box primary">
          <div class="result-label">Monthly Payment</div>
          <div class="result-value">₱{{c.result.monthlyPayment | number:2}}</div>
        </div>
        
        <div class="result-box">
          <div class="result-label">Total Amount to Pay</div>
          <div class="result-value">₱{{c.result.totalPayment | number:2}}</div>
        </div>
        
        <div class="result-box">
          <div class="result-label">Total Interest</div>
          <div class="result-value">₱{{c.result.totalInterest | number:2}}</div>
        </div>
        
        <div class="result-box">
          <div class="result-label">Principal Amount</div>
          <div class="result-value">₱{{c.loanAmount | number:2}}</div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="alert alert-info mt-4">
    <i class="fa fa-info-circle"></i> 
    <strong>Note:</strong> This is an estimate only. Actual loan terms and rates may vary based on 
    your credit assessment and bank policies.
  </div>
</div>]]></template>
    <widget_script/>
    <widget_type>standard</widget_type>
</sp_widget>

